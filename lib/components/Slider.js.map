{"version":3,"sources":["../../src/components/Slider.js"],"names":["handleStyle","cursor","userSekect","MozUserSelect","KhtmlUserSelect","WebkitUserSelect","OUserSelect","mapToKeyCode","code","codes","Slider","index","e","stopPropagation","state","dragging","setState","dragIndex","dragStartX","nativeEvent","offsetX","props","dragChange","selection","selected","scale","invert","Math","abs","onChange","direction","keyCode","keyboardStep","round","window","addEventListener","dragEnd","removeEventListener","handleLabelFormat","formatLabelFunction","width","height","reset","selectedColor","unselectedColor","sliderStyle","showLabels","selectionWidth","selectionSorted","Array","from","sort","a","b","defaultLabelFormatFunction","f","touchAction","mouseMove","map","m","i","keyDown","bind","outline","dragStart","Component","propTypes","data","PropTypes","arrayOf","shape","x0","number","x","y","isRequired","innerWidth","padding","bucketSize","selectionColor","string","histogramPadding","func","object","bool","labelStyle","defaultProps","display","paddingBottom","zIndex","overflow"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { format as d3Format } from \"d3-format\";\n\nconst handleStyle = {\n  cursor: \"move\",\n  userSekect: \"none\",\n  MozUserSelect: \"none\",\n  KhtmlUserSelect: \"none\",\n  WebkitUserSelect: \"none\",\n  OUserSelect: \"none\",\n};\n\n// Map keycodes to positive or negative values\nexport const mapToKeyCode = (code) => {\n  const codes = {\n    37: -1,\n    38: 1,\n    39: 1,\n    40: -1,\n  };\n  return codes[code] || null;\n};\n\nclass Slider extends Component {\n  componentDidMount() {\n    window.addEventListener(\"mouseup\", this.dragEnd, false);\n    window.addEventListener(\"touchend\", this.dragEnd, false);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"mouseup\", this.dragEnd, false);\n    window.removeEventListener(\"touchend\", this.dragEnd, false);\n  }\n\n  constructor() {\n    super();\n    this.state = {\n      dragging: false,\n      dragStartX: null,\n    };\n  }\n\n  dragStart = (index, e) => {\n    e.stopPropagation();\n    if (!this.state.dragging) {\n      this.setState(\n        {\n          dragging: true,\n          dragIndex: index,\n          dragStartX: e.nativeEvent.offsetX,\n        },\n        () => {\n          this.props.dragChange(true);\n        }\n      );\n    }\n  };\n\n  dragEnd = (e) => {\n    e.stopPropagation();\n    this.setState(\n      {\n        dragging: false,\n        dragIndex: null,\n        dragStartX: null,\n      },\n      () => {\n        this.props.dragChange(false);\n      }\n    );\n  };\n\n  dragFromSVG = (e) => {\n    if (!this.state.dragging) {\n      let selection = [...this.props.selection];\n      let selected = this.props.scale.invert(e.nativeEvent.offsetX);\n      let dragIndex;\n\n      if (\n        Math.abs(selected - selection[0]) > Math.abs(selected - selection[1])\n      ) {\n        selection[1] = selected;\n        dragIndex = 0;\n      } else {\n        selection[0] = selected;\n        dragIndex = 1;\n      }\n\n      this.props.onChange(selection);\n      this.setState(\n        {\n          dragging: true,\n          dragIndex,\n        },\n        () => {\n          this.props.dragChange(true);\n        }\n      );\n    }\n  };\n\n  mouseMove = (e) => {\n    if (this.state.dragging) {\n      let selection = [...this.props.selection];\n      selection[this.state.dragIndex] = this.props.scale.invert(\n        e.nativeEvent.offsetX\n      );\n      this.props.onChange(selection);\n    }\n  };\n\n  keyDown = (index, e) => {\n    const direction = mapToKeyCode(e.keyCode);\n    const { keyboardStep } = this.props;\n    let selection = [...this.props.selection];\n    selection[index] = Math.round(selection[index] + direction * keyboardStep);\n    this.props.onChange(selection);\n  };\n\n  render() {\n    const {\n      selection,\n      scale,\n      handleLabelFormat,\n      formatLabelFunction,\n      width,\n      height,\n      reset,\n      selectedColor,\n      unselectedColor,\n      sliderStyle,\n      showLabels,\n    } = this.props;\n    const selectionWidth = Math.abs(scale(selection[1]) - scale(selection[0]));\n    const selectionSorted = Array.from(selection).sort((a, b) => +a - +b);\n    const defaultLabelFormatFunction = d3Format(handleLabelFormat);\n    const f = formatLabelFunction || defaultLabelFormatFunction;\n    return (\n      <svg\n        style={{ ...sliderStyle, touchAction: \"none\" }}\n        height={height}\n        width={width}\n        onDoubleClick={reset}\n        onPointerMove={this.mouseMove}\n      >\n        <rect height={4} fill={unselectedColor} x={0} y={10} width={width} />\n        <rect\n          height={4}\n          fill={selectedColor}\n          x={scale(selectionSorted[0])}\n          y={10}\n          width={selectionWidth}\n        />\n        {selection.map((m, i) => {\n          return (\n            <g\n              tabIndex={0}\n              onKeyDown={this.keyDown.bind(this, i)}\n              transform={`translate(${this.props.scale(m)}, 0)`}\n              key={`handle-${i}`}\n              style={{ outline: \"none\" }}\n            >\n              <circle\n                style={handleStyle}\n                r={10}\n                cx={0}\n                cy={12.5}\n                fill=\"#ddd\"\n                strokeWidth=\"1\"\n              />\n              <circle\n                style={handleStyle}\n                onPointerDown={this.dragStart.bind(this, i)}\n                r={9}\n                cx={0}\n                cy={12}\n                fill=\"white\"\n                stroke=\"#ccc\"\n                strokeWidth=\"1\"\n              />\n              {showLabels ? (\n                <text\n                  style={handleStyle}\n                  textAnchor=\"middle\"\n                  x={0}\n                  y={36}\n                  fill=\"#666\"\n                  fontSize={12}\n                >\n                  {f(m)}\n                </text>\n              ) : null}\n            </g>\n          );\n        })}\n      </svg>\n    );\n  }\n}\n\nSlider.propTypes = {\n  data: PropTypes.arrayOf(\n    PropTypes.shape({\n      x0: PropTypes.number,\n      x: PropTypes.number,\n      y: PropTypes.number,\n    })\n  ).isRequired,\n  selection: PropTypes.arrayOf(PropTypes.number).isRequired,\n  height: PropTypes.number,\n  width: PropTypes.number,\n  innerWidth: PropTypes.number,\n  padding: PropTypes.number,\n  bucketSize: PropTypes.number,\n  selectionColor: PropTypes.string,\n  histogramPadding: PropTypes.number,\n  scale: PropTypes.func,\n  reset: PropTypes.func,\n  keyboardStep: PropTypes.number,\n  dragChange: PropTypes.func,\n  onChange: PropTypes.func,\n  handleLabelFormat: PropTypes.string,\n  formatLabelFunction: PropTypes.func,\n  sliderStyle: PropTypes.object,\n  showLabels: PropTypes.bool,\n  labelStyle: PropTypes.object,\n  selectedColor: PropTypes.string,\n  unselectedColor: PropTypes.string,\n};\n\nSlider.defaultProps = {\n  sliderStyle: {\n    display: \"block\",\n    paddingBottom: \"8px\",\n    zIndex: 6,\n    overflow: \"visible\",\n  },\n  keyboardStep: 1,\n  showLabels: true,\n};\n\nexport default Slider;\n"],"file":"Slider.js"}